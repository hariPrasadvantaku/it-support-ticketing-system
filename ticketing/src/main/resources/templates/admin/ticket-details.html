<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Admin Ticket</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
</head>
<body class="bg-light">
	<div th:replace="fragments/navbar :: body"></div>
	<div class="container mt-4">

		<div class="card shadow mb-3">
			<div class="card-body">
				<h4 th:text="${ticket.title}"></h4>
				<p th:text="${ticket.description}"></p>

				<form th:action="@{/admin/tickets/assign}" method="post">
					<input type="hidden" name="ticketId" th:value="${ticket.id}">
					<select name="supportId" class="form-select w-50 d-inline">
						<option th:each="s : ${supports}" th:value="${s.id}"
							th:text="${s.username}"></option>
					</select>
					<button class="btn btn-warning ms-2">Assign</button>
				</form>

			</div>
		</div>

		<!-- Images -->
		<div class="card shadow mb-3" th:if="${images != null}">
			<div class="card-body">
				<h5>Attachments</h5>
				<div class="row g-3">
					<div class="col-md-3" th:each="img : ${images}">
						<img th:src="@{'/images/' + ${img.id}}"
							class="img-fluid rounded border">
					</div>
				</div>
			</div>
		</div>

		<!-- Comments -->
		<div class="card shadow mb-3">
			<div class="card-body">
				<h5>Comments</h5>
				<div class="border p-2 mb-2" th:each="c : ${comments}">
					<b th:text="${c.user.username}"></b> <small
						th:text="${#temporals.format(c.createdAt,'dd MMM yyyy HH:mm')}"></small>
					<p th:text="${c.content}"></p>
				</div>
			</div>
		</div>

		<!-- History -->
		<div class="card shadow">
			<div class="card-body">
				<h5>Status History</h5>
				<ul class="list-group">
					<li class="list-group-item" th:each="h : ${statusHistory}"><b
						th:text="${h.oldStatus}"></b> â†’ <b th:text="${h.newStatus}"></b> <br>
						<small
						th:text="${#temporals.format(h.changedAt,'dd MMM yyyy HH:mm')}"></small>
					</li>
				</ul>
			</div>
		</div>

	</div>
</body>
</html>
